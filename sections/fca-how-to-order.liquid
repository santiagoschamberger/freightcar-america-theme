{%- style -%}
  @font-face {
    font-family: 'Outage';
    src: url('{{ 'Outage.ttf' | asset_url }}') format('truetype');
    font-weight: normal;
    font-style: normal;
    font-display: swap;
  }

  @font-face {
    font-family: 'Gotham';
    src: url('{{ 'Gotham-Book.otf' | asset_url }}') format('opentype');
    font-weight: 400;
    font-style: normal;
    font-display: swap;
  }

  @font-face {
    font-family: 'Gotham';
    src: url('{{ 'Gotham-Medium.otf' | asset_url }}') format('opentype');
    font-weight: 500;
    font-style: normal;
    font-display: swap;
  }

  @font-face {
    font-family: 'Gotham';
    src: url('{{ 'Gotham-Bold.otf' | asset_url }}') format('opentype');
    font-weight: 700;
    font-style: normal;
    font-display: swap;
  }

  .fca-how-to-order {
    position: relative;
    min-height: 780px;
    display: flex;
    align-items: center;
    background: {% if section.settings.background_image %}url('{{ section.settings.background_image | image_url }}'){% else %}#FFFFFF{% endif %};
    background-size: cover;
    background-position: center;
    color: #00205B;
    overflow: hidden;
    padding: 80px 0;
    border-bottom: 4px solid #D31244;
    margin-bottom: 5px;
  }

  .fca-how-to-order__container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    position: relative;
  }

  .fca-how-to-order__title {
    font-family: 'Outage', sans-serif;
    font-weight: 700;
    font-size: 60px;
    line-height: 1.2;
    text-align: center;
    margin-bottom: 0px !important;
    color: #122F5B;
  }

  /* Red highlight class for title text */
  .fca-how-to-order .red-highlight {
    color: #D31244;
    display: inline;
    background: none;
    padding: 0;
    clip-path: none;
  }

  .fca-how-to-order .red-highlight::before {
    display: none;
  }

  .fca-how-to-order__slider-container {
    position: relative;
    margin-bottom: 80px;
  }

  .fca-how-to-order__slider {
    position: relative;
    overflow: hidden;
    height: 400px;
  }

  .fca-how-to-order__slides {
    display: flex;
    transition: transform 0.5s ease-in-out;
    height: 100%;
  }

  .fca-how-to-order__slide {
    min-width: 100%;
    display: flex;
    flex-direction: row;
    height: 100%;
    background: #FFFFFF;
  }

  .fca-how-to-order__image-column {
    flex: 0 0 400px;
    height: 100%;
    position: relative;
    overflow: hidden;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .fca-how-to-order__step-number {
    font-family: 'Outage', sans-serif;
    font-weight: 700;
    font-size: 280px;
    line-height: 0.26;
    color: rgba(0, 32, 91, 0.1);
    position: absolute;
    z-index: 1;
    display: none !Important;
  }

  .fca-how-to-order__step-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center;
    position: relative;
    z-index: 2;
  }

  .fca-how-to-order__content-column {
    flex: 1;
    padding: 0px 80px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    background: #FFFFFF;
  }

  .fca-how-to-order__step-title {
    font-family: 'Gotham', sans-serif;
    font-weight: 700;
    font-size: 24px;
    line-height: 1.08;
    color: #D31244;
    margin: 0 0 20px 0;
  }

  .fca-how-to-order__step-description {
    font-family: 'Gotham', sans-serif;
    font-weight: 400;
    font-size: 20px;
    line-height: 1.3;
    color: #00205B;
    margin: 0;
  }

  .fca-how-to-order__navigation {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 16px;
    margin-top: 0px;
  }

  .fca-how-to-order__progress-dot {
    width: 20px;
    height: 20px;
    background: #D9D9D9;
    cursor: pointer;
    transition: all 0.3s ease;
    border: none;
  }

  .fca-how-to-order__progress-dot.active {
    background: #D31244;
  }

  .fca-how-to-order__progress-dot:hover {
    opacity: 0.8;
  }

  .fca-how-to-order__button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    background: #D31244;
    color: white;
    padding: 20px 24px 17px;
    text-decoration: none;
    font-family: 'Outage', sans-serif;
    font-weight: 700;
    font-size: 20px;
    line-height: 1;
    border-radius: 0;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
    text-align: center;
  }

  .fca-how-to-order__button:hover {
    background: #BF0D3D;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(211, 18, 68, 0.3);
  }

  @media (max-width: 768px) {
    .fca-how-to-order {
      min-height: 600px;
      padding: 60px 0;
    }

    .fca-how-to-order__container {
      padding: 0 20px;
    }

    .fca-how-to-order__title {
      font-size: 32px;
      margin-bottom: 40px;
      text-align: left;
    }

    .fca-how-to-order__slider {
      height: 280px;
    }

    .fca-how-to-order__slide {
      flex-direction: column;
      height: auto;
    }

    .fca-how-to-order__image-column {
      flex: none;
      width: 100%;
      height: 250px;
      order: 1;
    }

    .fca-how-to-order__step-number {
      font-size: 180px;
    }

    .fca-how-to-order__content-column {
      flex: none;
      width: 100%;
      padding: 40px 30px;
      order: 2;
    }

    .fca-how-to-order__navigation {
      margin-top: 20px;
      margin-bottom: 40px;
      gap: 12px;
    }
  }

  @media (max-width: 480px) {
    .fca-how-to-order__container {
      padding: 0 16px;
    }

    .fca-how-to-order__title {
      font-size: 28px;
    }

    .fca-how-to-order__image-column {
      height: 200px;
    }

    .fca-how-to-order__step-number {
      font-size: 120px;
    }

    .fca-how-to-order__content-column {
      padding: 30px 20px;
    }

    .fca-how-to-order__step-title {
      font-size: 20px;
    }

    .fca-how-to-order__step-description {
      font-size: 16px;
    }
  }
{%- endstyle -%}

<section class="fca-how-to-order">
  <div class="fca-how-to-order__container">
    {%- if section.settings.title != blank -%}
      <h2 class="fca-how-to-order__title">
        {%- if section.settings.red_highlight_text != blank -%}
          {%- assign red_replacement = '<span class="red-highlight">' | append: section.settings.red_highlight_text | append: '</span>' -%}
          {%- assign highlighted_title = section.settings.title | replace: section.settings.red_highlight_text, red_replacement -%}
          {{ highlighted_title }}
        {%- else -%}
          {{ section.settings.title }}
        {%- endif -%}
      </h2>
    {%- endif -%}
    
    <div class="fca-how-to-order__slider-container">
      <div class="fca-how-to-order__slider" id="slider-{{ section.id }}">
        <div class="fca-how-to-order__slides" id="slides-{{ section.id }}">
          {%- for block in section.blocks -%}
            <div class="fca-how-to-order__slide" data-slide="{{ forloop.index0 }}">
              <div class="fca-how-to-order__image-column">
                {%- case forloop.index -%}
                  {%- when 1 -%}
                    {%- assign step_number = '01' -%}
                    {%- assign image_name = 'number1.png' -%}
                  {%- when 2 -%}
                    {%- assign step_number = '04' -%}
                    {%- assign image_name = 'number4.png' -%}
                  {%- when 3 -%}
                    {%- assign step_number = '03' -%}
                    {%- assign image_name = 'number3.png' -%}
                  {%- when 4 -%}
                    {%- assign step_number = '02' -%}
                    {%- assign image_name = 'number2.png' -%}
                  {%- else -%}
                    {%- assign step_number = '01' -%}
                    {%- assign image_name = 'number1.png' -%}
                {%- endcase -%}
                <div class="fca-how-to-order__step-number">{{ step_number }}</div>
                <img src="{{ image_name | asset_url }}" 
                     alt="{{ block.settings.title | escape }}" 
                     class="fca-how-to-order__step-image">
              </div>
              <div class="fca-how-to-order__content-column">
                {%- if block.settings.title != blank -%}
                  <h3 class="fca-how-to-order__step-title">{{ block.settings.title }}</h3>
                {%- endif -%}
                {%- if block.settings.description != blank -%}
                  <p class="fca-how-to-order__step-description">{{ block.settings.description }}</p>
                {%- endif -%}
              </div>
            </div>
          {%- endfor -%}
        </div>
      </div>

      {%- if section.blocks.size > 1 -%}
        <div class="fca-how-to-order__navigation" id="progress-{{ section.id }}">
          {%- for block in section.blocks -%}
            <button class="fca-how-to-order__progress-dot{% if forloop.first %} active{% endif %}" 
                    data-slide="{{ forloop.index0 }}" 
                    aria-label="Go to step {{ forloop.index }}">
            </button>
          {%- endfor -%}
        </div>
      {%- endif -%}
    </div>

    {%- if section.settings.button_text != blank and section.settings.button_url != blank -%}
      <div style="text-align: center;">
        <a href="{{ section.settings.button_url }}" class="fca-how-to-order__button">
          {{ section.settings.button_text }}
        </a>
      </div>
    {%- endif -%}
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const sectionId = '{{ section.id }}';
  const slider = document.getElementById('slider-' + sectionId);
  const slides = document.getElementById('slides-' + sectionId);
  const progressDots = document.querySelectorAll('#progress-' + sectionId + ' .fca-how-to-order__progress-dot');
  
  if (!slider || !slides) return;
  
  let currentSlide = 0;
  const totalSlides = slides.children.length;
  
  function updateSlider() {
    const translateX = -currentSlide * 100;
    slides.style.transform = `translateX(${translateX}%)`;
    
    // Update progress dots
    progressDots.forEach((dot, index) => {
      dot.classList.toggle('active', index === currentSlide);
    });
  }
  
  function nextSlide() {
    currentSlide = (currentSlide + 1) % totalSlides;
    updateSlider();
  }
  
  function prevSlide() {
    currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
    updateSlider();
  }
  
  function goToSlide(slideIndex) {
    currentSlide = slideIndex;
    updateSlider();
  }
  
  // Progress dots
  progressDots.forEach((dot, index) => {
    dot.addEventListener('click', () => goToSlide(index));
  });
  
  // Touch/swipe support for mobile
  let startX = 0;
  let endX = 0;
  
  slider.addEventListener('touchstart', (e) => {
    startX = e.touches[0].clientX;
  });
  
  slider.addEventListener('touchend', (e) => {
    endX = e.changedTouches[0].clientX;
    const diff = startX - endX;
    
    if (Math.abs(diff) > 50) { // Minimum swipe distance
      if (diff > 0) {
        nextSlide();
      } else {
        prevSlide();
      }
    }
  });
  
  // Keyboard navigation
  slider.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') {
      prevSlide();
    } else if (e.key === 'ArrowRight') {
      nextSlide();
    }
  });
});
</script>

{% schema %}
{
  "name": "FCA How to Order",
  "tag": "section",
  "class": "section-fca-how-to-order",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "How to Order"
    },
    {
      "type": "text",
      "id": "red_highlight_text",
      "label": "Text to Highlight (Red)",
      "default": "ORDER",
      "info": "This text will be highlighted in red in the title"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Request an account"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    }
  ],
  "blocks": [
    {
      "type": "step",
      "name": "Order Step",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Step Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Step Title",
          "default": "Step Title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Step Description",
          "default": "Step description goes here."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FCA How to Order",
      "settings": {
        "title": "How to Order",
        "red_highlight_text": "ORDER",
        "button_text": "Request an account"
      },
      "blocks": [
        {
          "type": "step",
          "settings": {
            "title": "Create an Account",
            "description": "Set up a quick, secure account to manage your orders and track your parts."
          }
        },
        {
          "type": "step",
          "settings": {
            "title": "Browse Our Catalog",
            "description": "Search through our extensive inventory of railcar parts and components."
          }
        },
        {
          "type": "step",
          "settings": {
            "title": "Place Your Order",
            "description": "Add items to your cart and complete your order with secure checkout."
          }
        },
        {
          "type": "step",
          "settings": {
            "title": "Track & Receive",
            "description": "Monitor your order status and receive your parts on time."
          }
        }
      ]
    }
  ]
}
{% endschema %} 